services:
  initializer:
    container_name: initializer
    image: alloranetwork/allora-chain:latest
    volumes:
      - ./data:/data
    entrypoint: /data/scripts/init.sh
    environment:
      - NAME=offchain_node

  source:
    container_name: offchain_source
    build: ./adapter/api/source
    ports:
      - "8000:8000"

  node:
    container_name: offchain_node
    build: .
    environment:
      - ALLORA_NODE_RPC=https://allora-rpc.testnet-1.testnet.allora.network
      - INFERENCE_URL=http://source:8000/inference
      - FORECAST_URL=http://source:8000/forecast
      - TRUTH_URL=http://source:8000/truth
    volumes:
      - ./data:/data
    depends_on:
      - initializer
      - source
    env_file:
      - ./data/env_file 
